<script> const animationContainer = document.querySelector('.animation'); const canvas = document.getElementById('canvas'); const ctx = canvas.getContext('2d'); let mediaRecorder; let chunks = []; function drawFrame() { ctx.clearRect(0, 0, canvas.width, canvas.height); ctx.save(); ctx.scale(1, -1); ctx.translate(0, -canvas.height); ctx.drawImage(animationContainer, 0, 0); ctx.restore(); } function startRecording() { let stream = canvas.captureStream(30); // 30 fps mediaRecorder = new MediaRecorder(stream, { mimeType: 'video/webm' }); mediaRecorder.ondataavailable = function(event) { if (event.data.size > 0) { chunks.push(event.data); } }; mediaRecorder.onstop = function() { let blob = new Blob(chunks, { type: 'video/webm' }); let url = URL.createObjectURL(blob); let a = document.createElement('a'); a.style.display = 'none'; a.href = url; a.download = 'hoat_anh.webm'; document.body.appendChild(a); a.click(); window.URL.revokeObjectURL(url); }; mediaRecorder.start(); // Dừng ghi sau 6 giây (6 giây * 30 khung hình mỗi giây) setTimeout(() => { mediaRecorder.stop(); }, 6000); } function animate() { drawFrame(); requestAnimationFrame(animate); } window.onload = function() { animate(); startRecording(); }; </script>
